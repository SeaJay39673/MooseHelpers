#!/bin/bash
while getopts ':awp:n:t:i:' OPTION; do
	case "$OPTION" in
		a)
			watch="Alert"
		;;
		w)
			win="-w"
		;;
		p)
			path="$OPTARG"
		;;
		n)
			paralell="mpiexec -n $OPTARG"
		;;
		t)
			threads="--n-threads=$OPTARG"
		;;
		i)
			file="$OPTARG"
		;;
		?)
			echo "script usage: $(basename $0) [-a (Alert)] [-w (Alert with window)] [-p <path-to-opt>] [-n cores] [-t threads] [-i <path-to-input-file>]"
			exit 1
		;;
	esac
done

#shift "$(($OPTIND -1))" #Not needed

if [ -z "$file" ]; then
	echo "input file not provided"
	exit 1
fi

if [[ $file != *.i ]]; then
	echo "incorrect file type"
	exit 1
fi

if [ -z "${path+x}" ]; then path=$(find ../ -type f -name '*-opt'); fi

eval "$watch $win $paralell ./$path -i $file $threads"
